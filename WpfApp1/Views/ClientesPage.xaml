<Page x:Class="WpfApp1.Views.ClientesPage"
      xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
      xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
      xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" 
      xmlns:d="http://schemas.expression/blend/2008" 
      xmlns:local="clr-namespace:WpfApp1.Views"
      mc:Ignorable="d" 
      d:DesignHeight="600" d:DesignWidth="800"
      Title="ClientesPage"
      Background="White">

    <Grid>
        <ScrollViewer VerticalScrollBarVisibility="Auto" HorizontalScrollBarVisibility="Disabled">

            <Grid Margin="20">
                <Grid.RowDefinitions>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="*"/>
                </Grid.RowDefinitions>

                <StackPanel Grid.Row="0" Orientation="Vertical">

                    <TextBlock Text="Clientes" 
                               FontSize="24" 
                               FontWeight="Bold" 
                               Margin="0,0,0,15"/>

                    <Grid Margin="0,0,0,10">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="*"/>
                        </Grid.ColumnDefinitions>

                        <TextBox Grid.Column="0" 
                                 x:Name="txtBusqueda" 
                                 Padding="5" 
                                 VerticalContentAlignment="Center"
                                 Text="Buscar cliente por RFC o razón social"
                                 Foreground="Gray"
                                 TextChanged="txtBusqueda_TextChanged"
                                 GotFocus="txtBusqueda_GotFocus"     
                                 LostFocus="txtBusqueda_LostFocus"/>
                    </Grid>

                    <Grid Margin="0,0,0,10">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="*"/>
                            <ColumnDefinition Width="Auto"/>
                        </Grid.ColumnDefinitions>

                        <StackPanel Grid.Column="0" Orientation="Horizontal" VerticalAlignment="Center">
                            <CheckBox x:Name="chkActivos" Content="Clientes activos" 
                                      IsChecked="True" 
                                      Margin="0,0,15,0"
                                      Click="chkStatus_Click"/>
                            <CheckBox x:Name="chkInactivos" Content="Clientes inactivos" 
                                      Margin="0,0,15,0"
                                      Click="chkStatus_Click"/>
                        </StackPanel>

                        <Button Grid.Column="1"
                                x:Name="btnNuevoCliente"
                                Content="Nuevo cliente" 
                                FontWeight="Bold"
                                Padding="10,5"
                                Click="btnNuevoCliente_Click"/>
                    </Grid>

                    <StackPanel x:Name="spAccionesSeleccion" 
                                Orientation="Horizontal" 
                                Visibility="Collapsed" 
                                Margin="0,5,0,10">
                        <TextBlock x:Name="txtConteoSeleccion" 
                                   Text="0 Clientes seleccionados" 
                                   VerticalAlignment="Center" 
                                   FontWeight="SemiBold"
                                   Foreground="Gray"/>
                        <Button x:Name="btnDeshabilitarSeleccion" 
                                Content="Deshabilitar selección" 
                                Margin="10,0,0,0"
                                Padding="10,5"
                                Background="#F44336" 
                                Foreground="White"
                                BorderThickness="0"
                                Click="btnDeshabilitarSeleccion_Click"/>
                    </StackPanel>

                </StackPanel>

                <DataGrid Grid.Row="1"
                          AutoGenerateColumns="False"
                          ItemsSource="{Binding Clientes}" IsReadOnly="True"
                          CanUserAddRows="False"
                          VerticalGridLinesBrush="Transparent"
                          HorizontalGridLinesBrush="#EEE"
                          Margin="0,10,0,0">

                    <DataGrid.Columns>

                        <DataGridTemplateColumn Width="Auto">
                            <DataGridTemplateColumn.Header>
                                <CheckBox x:Name="chkSeleccionarTodo" 
                                          Click="chkSeleccionarTodo_Click" />
                            </DataGridTemplateColumn.Header>
                            <DataGridTemplateColumn.CellTemplate>
                                <DataTemplate>
                                    <CheckBox IsChecked="{Binding IsSelected, UpdateSourceTrigger=PropertyChanged}" 
                                              HorizontalAlignment="Center" 
                                              VerticalAlignment="Center"
                                              Checked="ClienteCheckBox_Changed"   
                                              Unchecked="ClienteCheckBox_Changed"/>
                                </DataTemplate>
                            </DataGridTemplateColumn.CellTemplate>
                        </DataGridTemplateColumn>

                        <DataGridTextColumn Header="ID" Binding="{Binding ID}" Width="60"/>
                        <DataGridTextColumn Header="RFC" Binding="{Binding RFC}" Width="*"/>
                        <DataGridTextColumn Header="Razón social" Binding="{Binding RazonSocial}" Width="2*"/>
                        <DataGridTextColumn Header="Teléfono" Binding="{Binding Telefono}" Width="120"/>
                        <DataGridTextColumn Header="Venta" Binding="{Binding Venta, StringFormat=C}" Width="100"/>

                        <DataGridTemplateColumn Header="Creado" Width="110">
                            <DataGridTemplateColumn.CellTemplate>
                                <DataTemplate>
                                    <Border Background="#EEE" 
                                            CornerRadius="10" 
                                            Padding="8,3"
                                            HorizontalAlignment="Center">
                                        <TextBlock Text="{Binding Creado, StringFormat='dd/MM/yyyy'}" />
                                    </Border>
                                </DataTemplate>
                            </DataGridTemplateColumn.CellTemplate>
                        </DataGridTemplateColumn>

                        <DataGridTemplateColumn Header="Acciones" Width="200">
                            <DataGridTemplateColumn.CellTemplate>
                                <DataTemplate>
                                    <StackPanel Orientation="Horizontal" HorizontalAlignment="Center">
                                        <Button Content="Info" Margin="3" ToolTip="Ver detalles"/>
                                        <Button Content="Editar" Margin="3" ToolTip="Editar cliente"/>
                                        <Button x:Name="btnCambiarEstado"
                                                Margin="3" 
                                                Click="btnCambiarEstado_Click">

                                            <Button.Style>
                                                <Style TargetType="Button">

                                                    <Setter Property="Content" Value="Activar"/>
                                                    <Setter Property="ToolTip" Value="Activar este cliente"/>
                                                    <Setter Property="Foreground" Value="Green"/>
                                                    <Setter Property="FontWeight" Value="Bold"/>

                                                    <Style.Triggers>
                                                        <DataTrigger Binding="{Binding Activo}" Value="True">
                                                            <Setter Property="Content" Value="Desactivar"/>
                                                            <Setter Property="ToolTip" Value="Desactivar este cliente"/>
                                                            <Setter Property="Foreground" Value="Red"/>
                                                        </DataTrigger>
                                                    </Style.Triggers>
                                                </Style>
                                            </Button.Style>
                                        </Button>
                                    </StackPanel>
                                </DataTemplate>
                            </DataGridTemplateColumn.CellTemplate>
                        </DataGridTemplateColumn>

                    </DataGrid.Columns>
                </DataGrid>

            </Grid>
        </ScrollViewer>
    </Grid>
</Page>